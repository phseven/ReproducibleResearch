# Adverse Weather Events: Health & Economic Impact in US (1951 -  Nov, 2011)

### Synopsis

The purpose of this analysis is to identify the adverse weather event types
that have caused the greatest number of fatalities and injuries to the 
US population, as well as inflicted the maximum damage to the US economy. 

According to this analysis, Tornado is the weather event associated with 
highest number of lives lost (5661) as well as causing highest number of
injuries (91407).

Flood is the weather event associated with highest property damage (more
than 150 billion USD) as well as combined economic damage (more than 
160 billion USD). 

Drought is the weather event that caused most crop damage (more than 
13 billion USD) followed closely by Flood (more than 10 billion USD).

The input for this analysis is storm events data from 1951 to November, 2011 
in the Storm Events Database maintained by the US National Weather 
Service (NWS).

The analysis is limited in following ways:

- The economic damage amounts are not inflation adjusted, so historical events
may appear to have less economic impact than recent events.

- Fewer events were captured in the earlier years of the database (most 
likely due to paucity of reliable records) compared to recent years, which 
may again skew the analysis in favor of more recent events.

- Other economic consequences like lost workdays, health costs etc. are not
captured in this analysis.


### Data Processing

Download and unzip the Storm Events datafile.

```{r}

# Load required packages

require(utils)
require(R.utils)
require(data.table)
require(ggplot2)
require(grid)

# -- set a seed

set.seed(11)

# Download and unzip input file if it does not exist in current directory

fl <- "repdata-data-StormData.csv"
fl.zip <- paste0(fl, ".bz2")
url<-"https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"

if (file.exists(fl) == FALSE) {
    if (file.exists(fl.zip) == FALSE) {
        download.file(url, destfile = fl.zip, method = "curl",
                      quiet = TRUE)    
    }
    bunzip2(fl.zip)
}

```

Load the input file. 

```{r}

colnms <- c("ST_ID","BGN_DATE","BGN_TIME","TIME_ZONE","COUNTY_ID",
            "COUNTYNAME","STATE","EVTYPE","BGN_RANGE","BGN_AZI",
            "BGN_LOCATI","END_DATE","END_TIME","COUNTY_END","COUNTYENDN",
            "END_RANGE","END_AZI","END_LOCATI","LENGTH","WIDTH",
            "F","MAG","FATALITIES","INJURIES","PROPDMG",
            "PROPDMGEXP","CROPDMG","CROPDMGEXP","WFO","STATEOFFICE",
            "ZONENAMES","LATITUDE","LONGITUDE","LATITUDE_E","LONGITUDE_E",
            "REMARKS","REFNUM")

colcls <- c("numeric", "character", "character", "character", "numeric", 
            "character", "character", "character", "numeric", "character",  
            "character",  "character",  "character", "numeric", "character", 
            "numeric", "character", "character", "numeric", "numeric",  
            "character", "numeric", "numeric", "numeric", "numeric",  
            "character", "numeric", "character", "character", "character", 
            "character","numeric", "numeric","numeric", "numeric",
            "character", "numeric")

# fread() fails to read input file, so read.table is used.

adf <- read.table( fl, header=TRUE, sep=",", colClasses=colcls,
               stringsAsFactors=FALSE, comment.char="", col.names=colnms)

# Convert to a data table.

adt <- as.data.table(adf)

# Set EVTYPE as key.

setkey(adt, EVTYPE)

# Release the memory of the dataframe.

rm(adf)

```

Create a new column UP.EVTYPE which is same as EVTYPE (event type) in 
uppercase. This will help in reducing the number of non-standard duplicate
event types. Summarize total number of fatalities, total number of injuries,
total property damage and total crop damage grouping by event types in 
uppercase. A count of records in each group is also obtained, though not used
in current analysis. It can be used in future to compute averages.

Summarization by UP.EVTYPE produces 898 summary rows from 902297 base data
rows.

As part of this summarization, the 2 fields in the base data for 
property damage, PROPDMG and PROPDMGEXP (exponent, e.g. K = 1000,
or 5 = 10^5) are combined into a single field pdmg using a function
convexp. The same procedure is also applied to crop damage, where two
fields CROPDMG and CROPDMGEXP are combined to form a single field cdmg.

```{r}
# Create a new column UP.EVTYPE in adt datatable which will contain
# EVTYPE values converted to uppercase.

adt[, UP.EVTYPE := toupper(EVTYPE), verbose = FALSE]

# Set UP.EVTYPE as the key for adt datatable.

setkey(adt, UP.EVTYPE)

# Function convexp takes a character x (exponent) and returns a number
# which is 10 to the power x. Valid values of x are h (hundred), 
# k (thousand), m (million), b (billion), and 0-9. For any other values
# of x a value of 1 is returned.

convexp <- function(x) { 
    exp <- switch( EXPR = tolower(x),
        "h" = 2, "k" = 3, "m" = 6, "b" = 9, 
        "0" = 0, "1" = 1, "2" = 2, "3" = 3,
        "4" = 4, "5" = 5, "6" = 6, "7" = 7, "8" = 8, "9" = 9,
        0 )
    
    10 ^ exp
}

# Create a new summary datatable ev with columns: dths = fatalities,
# inj = injuries, pdmg = property damage (with the property damage 
# exponent included), cdmg = crop damage (with the crop damage 
# exponent included) and cnt = count of rows grouped 
# by UP.EVTYPE column in the adt datatable.
# 

ev <- adt[, list(dths = sum(FATALITIES), inj = sum(INJURIES), 
            pdmg = sum(PROPDMG * vapply(PROPDMGEXP, convexp, 1.0)),
            cdmg = sum(CROPDMG * vapply(CROPDMGEXP, convexp, 1.0)),
            cnt = .N),
            keyby = UP.EVTYPE ]

```


Convert from non-standard (uppercase) event types to standard 48 event types
currently used by NWS / NCDC / NOAA. Two additional event types are added 
- "Other" : A suitable mapping not found for original event (e.g. drowning or
marine accident). Given more time for investigation, probably these events
can also be changed to standard event types. As such, the impact of the other
event type is low: deaths = 9, injuries = 11, property damage = 115500, 
crop damage = 1034400, count = 81.

A second event type "Ignore" is added to mark the rows which actually do not
contain data, but is used to describe the data. These includes rows whose
original event types may be Summary (used to describe, for instance, a 
thunderstorm event that spanned multiple counties) or Record High / Low (to
note a record high / low temperature). Eliminating these rows will improve
the actual count of each event type. Keeping or eliminating these rows, has
no effect on the total fatality, injury or property / crop damage 
statistics because these all values are zero for the Ignore event type.

The conversion from non-standard  (uppercase) event types to standard event 
types is based on National Weather Service Instruction (NWSI) 10-1605, dated 
August 17, 2007, available from: 

https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf

and some basic analysis of the data. For example, a microburst or gustnado 
event type is converted to a Thunderstorm Wind, based on the NWSI 10-1605
document. Where multiple event types are mentioned in the base data, it is
converted to the single (presumably) most important standard event type, e.g.
GLAZE/ICE STORM to Ice Storm, although it is not clear if this is the best
strategy.

The conversion uses table based mapping rather than regular
expression based substitution or natural language processing. Creating the
mapping table is not difficult (the hard part is deciding on which 
standard event type to map to), and provides a fine grained control of 
the mapping. Again, there may be better strategies. 

After the conversion to standard event types, a second level of summarization
is done by standard event types to produce 50 rows (48 + Other + Ignore)
from the prior summary of 898 rows.

```{r}

# Load the mapping data for converting non-standard event types to
# standard mapping data.

# -- Instead of sourcing the mapping data file, including it directly.

# sys.source("convev.R")


# The mapping between non-standard event types in
# the input file and corresponding standard event types.


# -- Unique non-standard events in the input file after converting 
# all events to uppercase.

up.ns.events <-  c("   HIGH SURF ADVISORY",
	" COASTAL FLOOD",
	" FLASH FLOOD",
	" LIGHTNING",
	" TSTM WIND",
	" TSTM WIND (G45)",
	" WATERSPOUT",
	" WIND",
	"?",
	"ABNORMAL WARMTH",
	"ABNORMALLY DRY",
	"ABNORMALLY WET",
	"ACCUMULATED SNOWFALL",
	"AGRICULTURAL FREEZE",
	"APACHE COUNTY",
	"ASTRONOMICAL HIGH TIDE",
	"ASTRONOMICAL LOW TIDE",
	"AVALANCE",
	"AVALANCHE",
	"BEACH EROSIN",
	"BEACH EROSION",
	"BEACH EROSION/COASTAL FLOOD",
	"BEACH FLOOD",
	"BELOW NORMAL PRECIPITATION",
	"BITTER WIND CHILL",
	"BITTER WIND CHILL TEMPERATURES",
	"BLACK ICE",
	"BLIZZARD",
	"BLIZZARD AND EXTREME WIND CHIL",
	"BLIZZARD AND HEAVY SNOW",
	"BLIZZARD WEATHER",
	"BLIZZARD/FREEZING RAIN",
	"BLIZZARD/HEAVY SNOW",
	"BLIZZARD/HIGH WIND",
	"BLIZZARD/WINTER STORM",
	"BLOW-OUT TIDE",
	"BLOW-OUT TIDES",
	"BLOWING DUST",
	"BLOWING SNOW",
	"BLOWING SNOW & EXTREME WIND CH",
	"BLOWING SNOW- EXTREME WIND CHI",
	"BLOWING SNOW/EXTREME WIND CHIL",
	"BREAKUP FLOODING",
	"BRUSH FIRE",
	"BRUSH FIRES",
	"BLIZZARD SUMMARY",
	"COASTAL  FLOODING/EROSION",
	"COASTAL EROSION",
	"COASTAL FLOOD",
	"COASTAL FLOODING",
	"COASTAL FLOODING/EROSION",
	"COASTAL STORM",
	"COASTAL SURGE",
	"COASTAL/TIDAL FLOOD",
	"COASTALFLOOD",
	"COASTALSTORM",
	"COLD",
	"COLD AIR FUNNEL",
	"COLD AIR FUNNELS",
	"COLD AIR TORNADO",
	"COLD AND FROST",
	"COLD AND SNOW",
	"COLD AND WET CONDITIONS",
	"COLD TEMPERATURES",
	"COLD WAVE",
	"COLD WEATHER",
	"COLD WIND CHILL TEMPERATURES",
	"COLD/WIND CHILL",
	"COLD/WINDS",
	"COOL AND WET",
	"COOL SPELL",
	"CSTL FLOODING/EROSION",
	"COLD TEMPERATURE",
	"DAM BREAK",
	"DAM FAILURE",
	"DAMAGING FREEZE",
	"DEEP HAIL",
	"DENSE FOG",
	"DENSE SMOKE",
	"DOWNBURST",
	"DOWNBURST WINDS",
	"DRIEST MONTH",
	"DROUGHT",
	"DROUGHT/EXCESSIVE HEAT",
	"DROWNING",
	"DRY",
	"DRY CONDITIONS",
	"DRY HOT WEATHER",
	"DRY MICROBURST",
	"DRY MICROBURST 50",
	"DRY MICROBURST 53",
	"DRY MICROBURST 58",
	"DRY MICROBURST 61",
	"DRY MICROBURST 84",
	"DRY MICROBURST WINDS",
	"DRY MIRCOBURST WINDS",
	"DRY PATTERN",
	"DRY SPELL",
	"DRY WEATHER",
	"DRYNESS",
	"DUST DEVEL",
	"DUST DEVIL",
	"DUST DEVIL WATERSPOUT",
	"DUST STORM",
	"DUST STORM/HIGH WINDS",
	"DUSTSTORM",
	"DRIFTING SNOW",
	"EARLY FREEZE",
	"EARLY FROST",
	"EARLY RAIN",
	"EARLY SNOW",
	"EARLY SNOWFALL",
	"EXCESSIVE",
	"EXCESSIVE HEAT",
	"EXCESSIVE HEAT/DROUGHT",
	"EXCESSIVE PRECIPITATION",
	"EXCESSIVE RAIN",
	"EXCESSIVE RAINFALL",
	"EXCESSIVE SNOW",
	"EXCESSIVE WETNESS",
	"EXCESSIVELY DRY",
	"EXTREME COLD",
	"EXTREME COLD/WIND CHILL",
	"EXTREME HEAT",
	"EXTREME WIND CHILL",
	"EXTREME WIND CHILL/BLOWING SNO",
	"EXTREME WIND CHILLS",
	"EXTREME WINDCHILL",
	"EXTREME WINDCHILL TEMPERATURES",
	"EXTREME/RECORD COLD",
	"EXTREMELY WET",
	"EROSION/CSTL FLOOD",
	"EXCESSIVE COLD",
	"EXTENDED COLD",
	"FALLING SNOW/ICE",
	"FIRST FROST",
	"FIRST SNOW",
	"FLASH FLOOD",
	"FLASH FLOOD - HEAVY RAIN",
	"FLASH FLOOD FROM ICE JAMS",
	"FLASH FLOOD LANDSLIDES",
	"FLASH FLOOD WINDS",
	"FLASH FLOOD/",
	"FLASH FLOOD/ FLOOD",
	"FLASH FLOOD/ STREET",
	"FLASH FLOOD/FLOOD",
	"FLASH FLOOD/HEAVY RAIN",
	"FLASH FLOOD/LANDSLIDE",
	"FLASH FLOODING",
	"FLASH FLOODING/FLOOD",
	"FLASH FLOODING/THUNDERSTORM WI",
	"FLASH FLOODS",
	"FLASH FLOOODING",
	"FLOOD",
	"FLOOD & HEAVY RAIN",
	"FLOOD FLASH",
	"FLOOD FLOOD/FLASH",
	"FLOOD WATCH/",
	"FLOOD/FLASH",
	"FLOOD/FLASH FLOOD",
	"FLOOD/FLASH FLOODING",
	"FLOOD/FLASH/FLOOD",
	"FLOOD/FLASHFLOOD",
	"FLOOD/RAIN/WIND",
	"FLOOD/RAIN/WINDS",
	"FLOOD/RIVER FLOOD",
	"FLOODING",
	"FLOODING/HEAVY RAIN",
	"FLOODS",
	"FOG",
	"FOG AND COLD TEMPERATURES",
	"FOREST FIRES",
	"FREEZE",
	"FREEZING DRIZZLE",
	"FREEZING DRIZZLE AND FREEZING",
	"FREEZING FOG",
	"FREEZING RAIN",
	"FREEZING RAIN AND SLEET",
	"FREEZING RAIN AND SNOW",
	"FREEZING RAIN SLEET AND",
	"FREEZING RAIN SLEET AND LIGHT",
	"FREEZING RAIN/SLEET",
	"FREEZING RAIN/SNOW",
	"FROST",
	"FROST/FREEZE",
	"FROST\\FREEZE",
	"FUNNEL",
	"FUNNEL CLOUD",
	"FUNNEL CLOUD.",
	"FUNNEL CLOUD/HAIL",
	"FUNNEL CLOUDS",
	"FUNNELS",
	"FLOOD/STRONG WIND",
	"FREEZING SPRAY",
	"GLAZE",
	"GLAZE ICE",
	"GLAZE/ICE STORM",
	"GRADIENT WIND",
	"GRADIENT WINDS",
	"GRASS FIRES",
	"GROUND BLIZZARD",
	"GUSTNADO",
	"GUSTNADO AND",
	"GUSTY LAKE WIND",
	"GUSTY THUNDERSTORM WIND",
	"GUSTY THUNDERSTORM WINDS",
	"GUSTY WIND",
	"GUSTY WIND/HAIL",
	"GUSTY WIND/HVY RAIN",
	"GUSTY WINDS",
	"GUSTY WIND/RAIN",
	"HAIL",
	"HAIL 0.75",
	"HAIL 0.88",
	"HAIL 075",
	"HAIL 088",
	"HAIL 1.00",
	"HAIL 1.75",
	"HAIL 1.75)",
	"HAIL 100",
	"HAIL 125",
	"HAIL 150",
	"HAIL 175",
	"HAIL 200",
	"HAIL 225",
	"HAIL 275",
	"HAIL 450",
	"HAIL 75",
	"HAIL 80",
	"HAIL 88",
	"HAIL ALOFT",
	"HAIL DAMAGE",
	"HAIL FLOODING",
	"HAIL STORM",
	"HAIL/ICY ROADS",
	"HAIL/WIND",
	"HAIL/WINDS",
	"HAILSTORM",
	"HAILSTORMS",
	"HARD FREEZE",
	"HAZARDOUS SURF",
	"HEAT",
	"HEAT DROUGHT",
	"HEAT WAVE",
	"HEAT WAVE DROUGHT",
	"HEAT WAVES",
	"HEAT/DROUGHT",
	"HEAVY LAKE SNOW",
	"HEAVY MIX",
	"HEAVY PRECIPATATION",
	"HEAVY PRECIPITATION",
	"HEAVY RAIN",
	"HEAVY RAIN AND FLOOD",
	"HEAVY RAIN EFFECTS",
	"HEAVY RAIN/FLOODING",
	"HEAVY RAIN/LIGHTNING",
	"HEAVY RAIN/MUDSLIDES/FLOOD",
	"HEAVY RAIN/SEVERE WEATHER",
	"HEAVY RAIN/SMALL STREAM URBAN",
	"HEAVY RAIN/SNOW",
	"HEAVY RAIN/URBAN FLOOD",
	"HEAVY RAIN/WIND",
	"HEAVY RAIN; URBAN FLOOD WINDS;",
	"HEAVY RAINFALL",
	"HEAVY RAINS",
	"HEAVY RAINS/FLOODING",
	"HEAVY SEAS",
	"HEAVY SHOWER",
	"HEAVY SHOWERS",
	"HEAVY SNOW",
	"HEAVY SNOW   FREEZING RAIN",
	"HEAVY SNOW & ICE",
	"HEAVY SNOW AND",
	"HEAVY SNOW AND HIGH WINDS",
	"HEAVY SNOW AND ICE",
	"HEAVY SNOW AND ICE STORM",
	"HEAVY SNOW AND STRONG WINDS",
	"HEAVY SNOW ANDBLOWING SNOW",
	"HEAVY SNOW SQUALLS",
	"HEAVY SNOW-SQUALLS",
	"HEAVY SNOW/BLIZZARD",
	"HEAVY SNOW/BLIZZARD/AVALANCHE",
	"HEAVY SNOW/BLOWING SNOW",
	"HEAVY SNOW/FREEZING RAIN",
	"HEAVY SNOW/HIGH",
	"HEAVY SNOW/HIGH WIND",
	"HEAVY SNOW/HIGH WINDS",
	"HEAVY SNOW/HIGH WINDS & FLOOD",
	"HEAVY SNOW/HIGH WINDS/FREEZING",
	"HEAVY SNOW/ICE",
	"HEAVY SNOW/ICE STORM",
	"HEAVY SNOW/SLEET",
	"HEAVY SNOW/SQUALLS",
	"HEAVY SNOW/WIND",
	"HEAVY SNOW/WINTER STORM",
	"HEAVY SNOWPACK",
	"HEAVY SURF",
	"HEAVY SURF COASTAL FLOODING",
	"HEAVY SURF/HIGH SURF",
	"HEAVY SWELLS",
	"HEAVY WET SNOW",
	"HIGH",
	"HIGH  SWELLS",
	"HIGH  WINDS",
	"HIGH SEAS",
	"HIGH SURF",
	"HIGH SURF ADVISORIES",
	"HIGH SURF ADVISORY",
	"HIGH SWELLS",
	"HIGH TEMPERATURE RECORD",
	"HIGH TIDES",
	"HIGH WATER",
	"HIGH WAVES",
	"HIGH WIND",
	"HIGH WIND (G40)",
	"HIGH WIND 48",
	"HIGH WIND 63",
	"HIGH WIND 70",
	"HIGH WIND AND HEAVY SNOW",
	"HIGH WIND AND HIGH TIDES",
	"HIGH WIND AND SEAS",
	"HIGH WIND DAMAGE",
	"HIGH WIND/ BLIZZARD",
	"HIGH WIND/BLIZZARD",
	"HIGH WIND/BLIZZARD/FREEZING RA",
	"HIGH WIND/HEAVY SNOW",
	"HIGH WIND/LOW WIND CHILL",
	"HIGH WIND/SEAS",
	"HIGH WIND/WIND CHILL",
	"HIGH WIND/WIND CHILL/BLIZZARD",
	"HIGH WINDS",
	"HIGH WINDS 55",
	"HIGH WINDS 57",
	"HIGH WINDS 58",
	"HIGH WINDS 63",
	"HIGH WINDS 66",
	"HIGH WINDS 67",
	"HIGH WINDS 73",
	"HIGH WINDS 76",
	"HIGH WINDS 80",
	"HIGH WINDS 82",
	"HIGH WINDS AND WIND CHILL",
	"HIGH WINDS DUST STORM",
	"HIGH WINDS HEAVY RAINS",
	"HIGH WINDS/",
	"HIGH WINDS/COASTAL FLOOD",
	"HIGH WINDS/COLD",
	"HIGH WINDS/FLOODING",
	"HIGH WINDS/HEAVY RAIN",
	"HIGH WINDS/SNOW",
	"HIGHWAY FLOODING",
	"HOT PATTERN",
	"HOT SPELL",
	"HOT WEATHER",
	"HOT/DRY PATTERN",
	"HURRICANE",
	"HURRICANE EMILY",
	"HURRICANE ERIN",
	"HURRICANE FELIX",
	"HURRICANE GORDON",
	"HURRICANE OPAL",
	"HURRICANE OPAL/HIGH WINDS",
	"HURRICANE-GENERATED SWELLS",
	"HURRICANE/TYPHOON",
	"HVY RAIN",
	"HYPERTHERMIA/EXPOSURE",
	"HYPOTHERMIA",
	"HYPOTHERMIA/EXPOSURE",
	"HAIL(0.75)",
	"HEATBURST",
	"HEAVY RAIN AND WIND",
	"HEAVY RAIN/HIGH SURF",
	"HEAVY SNOW SHOWER",
	"HEAVY SURF AND WIND",
	"HOT AND DRY",
	"HURRICANE EDOUARD",
	"ICE",
	"ICE AND SNOW",
	"ICE FLOES",
	"ICE JAM",
	"ICE JAM FLOODING",
	"ICE ON ROAD",
	"ICE PELLETS",
	"ICE ROADS",
	"ICE STORM",
	"ICE STORM AND SNOW",
	"ICE STORM/FLASH FLOOD",
	"ICE/SNOW",
	"ICE/STRONG WINDS",
	"ICY ROADS",
	"ICE FOG",
	"ICE JAM FLOOD (MINOR",
	"ICESTORM/BLIZZARD",
	"LACK OF SNOW",
	"LAKE EFFECT SNOW",
	"LAKE FLOOD",
	"LAKE-EFFECT SNOW",
	"LAKESHORE FLOOD",
	"LANDSLIDE",
	"LANDSLIDE/URBAN FLOOD",
	"LANDSLIDES",
	"LANDSLUMP",
	"LANDSPOUT",
	"LARGE WALL CLOUD",
	"LATE FREEZE",
	"LATE SEASON HAIL",
	"LATE SEASON SNOW",
	"LATE SNOW",
	"LIGHT FREEZING RAIN",
	"LIGHT SNOW",
	"LIGHT SNOW AND SLEET",
	"LIGHT SNOW/FREEZING PRECIP",
	"LIGHTING",
	"LIGHTNING",
	"LIGHTNING  WAUSEON",
	"LIGHTNING AND HEAVY RAIN",
	"LIGHTNING AND THUNDERSTORM WIN",
	"LIGHTNING AND WINDS",
	"LIGHTNING DAMAGE",
	"LIGHTNING FIRE",
	"LIGHTNING INJURY",
	"LIGHTNING THUNDERSTORM WINDS",
	"LIGHTNING THUNDERSTORM WINDSS",
	"LIGHTNING.",
	"LIGHTNING/HEAVY RAIN",
	"LIGNTNING",
	"LOCAL FLASH FLOOD",
	"LOCAL FLOOD",
	"LOCALLY HEAVY RAIN",
	"LOW TEMPERATURE",
	"LOW TEMPERATURE RECORD",
	"LOW WIND CHILL",
	"LATE SEASON SNOWFALL",
	"LATE-SEASON SNOWFALL",
	"LIGHT SNOW/FLURRIES",
	"LIGHT SNOWFALL",
	"MAJOR FLOOD",
	"MARINE HAIL",
	"MARINE HIGH WIND",
	"MARINE MISHAP",
	"MARINE STRONG WIND",
	"MARINE THUNDERSTORM WIND",
	"MARINE TSTM WIND",
	"MICROBURST",
	"MICROBURST WINDS",
	"MILD PATTERN",
	"MILD/DRY PATTERN",
	"MINOR FLOOD",
	"MINOR FLOODING",
	"MIXED PRECIP",
	"MIXED PRECIPITATION",
	"MODERATE SNOW",
	"MODERATE SNOWFALL",
	"MONTHLY PRECIPITATION",
	"MONTHLY RAINFALL",
	"MONTHLY SNOWFALL",
	"MONTHLY TEMPERATURE",
	"MUD SLIDE",
	"MUD SLIDES",
	"MUD SLIDES URBAN FLOODING",
	"MUD/ROCK SLIDE",
	"MUDSLIDE",
	"MUDSLIDE/LANDSLIDE",
	"MUDSLIDES",
	"MARINE ACCIDENT",
	"METRO STORM, MAY 26",
	"MILD AND DRY PATTERN",
	"MOUNTAIN SNOWS",
	"NEAR RECORD SNOW",
	"NON SEVERE HAIL",
	"NON TSTM WIND",
	"NON-SEVERE WIND DAMAGE",
	"NON-TSTM WIND",
	"NONE",
	"NORMAL PRECIPITATION",
	"NORTHERN LIGHTS",
	"NO SEVERE WEATHER",
	"OTHER",
	"PATCHY DENSE FOG",
	"PATCHY ICE",
	"PROLONG COLD",
	"PROLONG COLD/SNOW",
	"PROLONG WARMTH",
	"PROLONGED RAIN",
	"RAIN",
	"RAIN (HEAVY)",
	"RAIN AND WIND",
	"RAIN/SNOW",
	"RAIN/WIND",
	"RAINSTORM",
	"RAPIDLY RISING WATER",
	"RECORD  COLD",
	"RECORD COLD",
	"RECORD COLD AND HIGH WIND",
	"RECORD COLD/FROST",
	"RECORD COOL",
	"RECORD DRYNESS",
	"RECORD HEAT",
	"RECORD HEAT WAVE",
	"RECORD HIGH",
	"RECORD HIGH TEMPERATURE",
	"RECORD HIGH TEMPERATURES",
	"RECORD LOW",
	"RECORD LOW RAINFALL",
	"RECORD PRECIPITATION",
	"RECORD RAINFALL",
	"RECORD SNOW",
	"RECORD SNOW/COLD",
	"RECORD SNOWFALL",
	"RECORD TEMPERATURE",
	"RECORD TEMPERATURES",
	"RECORD WARM",
	"RECORD WARM TEMPS.",
	"RECORD WARMTH",
	"RECORD/EXCESSIVE HEAT",
	"RECORD/EXCESSIVE RAINFALL",
	"RED FLAG CRITERIA",
	"RED FLAG FIRE WX",
	"REMNANTS OF FLOYD",
	"RIP CURRENT",
	"RIP CURRENTS",
	"RIP CURRENTS HEAVY SURF",
	"RIP CURRENTS/HEAVY SURF",
	"RIVER AND STREAM FLOOD",
	"RIVER FLOOD",
	"RIVER FLOODING",
	"ROCK SLIDE",
	"ROGUE WAVE",
	"ROTATING WALL CLOUD",
	"ROUGH SEAS",
	"ROUGH SURF",
	"RURAL FLOOD",
	"RAIN DAMAGE",
	"RECORD MAY SNOW",
	"RECORD WINTER SNOW",
	"RECORD DRY MONTH",
	"SAHARAN DUST",
	"SEICHE",
	"SEVERE COLD",
	"SEVERE THUNDERSTORM",
	"SEVERE THUNDERSTORM WINDS",
	"SEVERE THUNDERSTORMS",
	"SEVERE TURBULENCE",
	"SLEET",
	"SLEET & FREEZING RAIN",
	"SLEET STORM",
	"SLEET/FREEZING RAIN",
	"SLEET/ICE STORM",
	"SLEET/RAIN/SNOW",
	"SLEET/SNOW",
	"SMALL HAIL",
	"SMALL STREAM",
	"SMALL STREAM AND",
	"SMALL STREAM AND URBAN FLOOD",
	"SMALL STREAM AND URBAN FLOODIN",
	"SMALL STREAM FLOOD",
	"SMALL STREAM FLOODING",
	"SMALL STREAM URBAN FLOOD",
	"SMALL STREAM/URBAN FLOOD",
	"SMOKE",
	"SNOW",
	"SNOW ACCUMULATION",
	"SNOW ADVISORY",
	"SNOW AND COLD",
	"SNOW AND HEAVY SNOW",
	"SNOW AND ICE",
	"SNOW AND ICE STORM",
	"SNOW AND SLEET",
	"SNOW AND WIND",
	"SNOW DROUGHT",
	"SNOW FREEZING RAIN",
	"SNOW SHOWERS",
	"SNOW SLEET",
	"SNOW SQUALL",
	"SNOW SQUALLS",
	"SNOW- HIGH WIND- WIND CHILL",
	"SNOW/ BITTER COLD",
	"SNOW/ ICE",
	"SNOW/BLOWING SNOW",
	"SNOW/COLD",
	"SNOW/FREEZING RAIN",
	"SNOW/HEAVY SNOW",
	"SNOW/HIGH WINDS",
	"SNOW/ICE",
	"SNOW/ICE STORM",
	"SNOW/RAIN",
	"SNOW/RAIN/SLEET",
	"SNOW/SLEET",
	"SNOW/SLEET/FREEZING RAIN",
	"SNOW/SLEET/RAIN",
	"SNOWFALL RECORD",
	"SNOWMELT FLOODING",
	"SNOWSTORM",
	"SNOW\\COLD",
	"SOUTHEAST",
	"STORM FORCE WINDS",
	"STORM SURGE",
	"STORM SURGE/TIDE",
	"STREAM FLOODING",
	"STREET FLOOD",
	"STREET FLOODING",
	"STRONG WIND",
	"STRONG WIND GUST",
	"STRONG WINDS",
	"SUMMARY OF MARCH 24-25",
	"SUMMARY OF MARCH 27",
	"SUMMARY OF MARCH 29",
	"SEASONAL SNOWFALL",
	"SML STREAM FLD",
	"SUMMARY AUGUST 10",
	"SUMMARY AUGUST 11",
	"SUMMARY AUGUST 17",
	"SUMMARY AUGUST 2-3",
	"SUMMARY AUGUST 21",
	"SUMMARY AUGUST 28",
	"SUMMARY AUGUST 4",
	"SUMMARY AUGUST 7",
	"SUMMARY AUGUST 9",
	"SUMMARY JAN 17",
	"SUMMARY JULY 23-24",
	"SUMMARY JUNE 18-19",
	"SUMMARY JUNE 5-6",
	"SUMMARY JUNE 6",
	"SUMMARY SEPT. 25-26",
	"SUMMARY SEPTEMBER 20",
	"SUMMARY SEPTEMBER 23",
	"SUMMARY SEPTEMBER 3",
	"SUMMARY SEPTEMBER 4",
	"SUMMARY OF APRIL 12",
	"SUMMARY OF APRIL 13",
	"SUMMARY OF APRIL 21",
	"SUMMARY OF APRIL 27",
	"SUMMARY OF APRIL 3RD",
	"SUMMARY OF AUGUST 1",
	"SUMMARY OF JULY 11",
	"SUMMARY OF JULY 2",
	"SUMMARY OF JULY 22",
	"SUMMARY OF JULY 26",
	"SUMMARY OF JULY 29",
	"SUMMARY OF JULY 3",
	"SUMMARY OF JUNE 10",
	"SUMMARY OF JUNE 11",
	"SUMMARY OF JUNE 12",
	"SUMMARY OF JUNE 13",
	"SUMMARY OF JUNE 15",
	"SUMMARY OF JUNE 16",
	"SUMMARY OF JUNE 18",
	"SUMMARY OF JUNE 23",
	"SUMMARY OF JUNE 24",
	"SUMMARY OF JUNE 3",
	"SUMMARY OF JUNE 30",
	"SUMMARY OF JUNE 4",
	"SUMMARY OF JUNE 6",
	"SUMMARY OF MARCH 14",
	"SUMMARY OF MARCH 23",
	"SUMMARY OF MARCH 24",
	"SUMMARY OF MAY 10",
	"SUMMARY OF MAY 13",
	"SUMMARY OF MAY 14",
	"SUMMARY OF MAY 22",
	"SUMMARY OF MAY 22 AM",
	"SUMMARY OF MAY 22 PM",
	"SUMMARY OF MAY 26 AM",
	"SUMMARY OF MAY 26 PM",
	"SUMMARY OF MAY 31 AM",
	"SUMMARY OF MAY 31 PM",
	"SUMMARY OF MAY 9-10",
	"SUMMARY: NOV. 16",
	"SUMMARY: NOV. 6-7",
	"SUMMARY: OCT. 20-21",
	"SUMMARY: OCTOBER 31",
	"SUMMARY: SEPT. 18",
	"THUDERSTORM WINDS",
	"THUNDEERSTORM WINDS",
	"THUNDERESTORM WINDS",
	"THUNDERSNOW",
	"THUNDERSTORM",
	"THUNDERSTORM  WINDS",
	"THUNDERSTORM DAMAGE",
	"THUNDERSTORM DAMAGE TO",
	"THUNDERSTORM HAIL",
	"THUNDERSTORM W INDS",
	"THUNDERSTORM WIND",
	"THUNDERSTORM WIND (G40)",
	"THUNDERSTORM WIND 50",
	"THUNDERSTORM WIND 52",
	"THUNDERSTORM WIND 56",
	"THUNDERSTORM WIND 59",
	"THUNDERSTORM WIND 59 MPH",
	"THUNDERSTORM WIND 59 MPH.",
	"THUNDERSTORM WIND 60 MPH",
	"THUNDERSTORM WIND 65 MPH",
	"THUNDERSTORM WIND 65MPH",
	"THUNDERSTORM WIND 69",
	"THUNDERSTORM WIND 98 MPH",
	"THUNDERSTORM WIND G50",
	"THUNDERSTORM WIND G51",
	"THUNDERSTORM WIND G52",
	"THUNDERSTORM WIND G55",
	"THUNDERSTORM WIND G60",
	"THUNDERSTORM WIND G61",
	"THUNDERSTORM WIND TREES",
	"THUNDERSTORM WIND.",
	"THUNDERSTORM WIND/ TREE",
	"THUNDERSTORM WIND/ TREES",
	"THUNDERSTORM WIND/AWNING",
	"THUNDERSTORM WIND/HAIL",
	"THUNDERSTORM WIND/LIGHTNING",
	"THUNDERSTORM WINDS",
	"THUNDERSTORM WINDS      LE CEN",
	"THUNDERSTORM WINDS 13",
	"THUNDERSTORM WINDS 2",
	"THUNDERSTORM WINDS 50",
	"THUNDERSTORM WINDS 52",
	"THUNDERSTORM WINDS 53",
	"THUNDERSTORM WINDS 60",
	"THUNDERSTORM WINDS 61",
	"THUNDERSTORM WINDS 62",
	"THUNDERSTORM WINDS 63 MPH",
	"THUNDERSTORM WINDS AND",
	"THUNDERSTORM WINDS FUNNEL CLOU",
	"THUNDERSTORM WINDS G",
	"THUNDERSTORM WINDS G60",
	"THUNDERSTORM WINDS HAIL",
	"THUNDERSTORM WINDS HEAVY RAIN",
	"THUNDERSTORM WINDS LIGHTNING",
	"THUNDERSTORM WINDS SMALL STREA",
	"THUNDERSTORM WINDS URBAN FLOOD",
	"THUNDERSTORM WINDS.",
	"THUNDERSTORM WINDS/ FLOOD",
	"THUNDERSTORM WINDS/ HAIL",
	"THUNDERSTORM WINDS/FLASH FLOOD",
	"THUNDERSTORM WINDS/FLOODING",
	"THUNDERSTORM WINDS/FUNNEL CLOU",
	"THUNDERSTORM WINDS/HAIL",
	"THUNDERSTORM WINDS/HEAVY RAIN",
	"THUNDERSTORM WINDS53",
	"THUNDERSTORM WINDSHAIL",
	"THUNDERSTORM WINDSS",
	"THUNDERSTORM WINS",
	"THUNDERSTORMS",
	"THUNDERSTORMS WIND",
	"THUNDERSTORMS WINDS",
	"THUNDERSTORMW",
	"THUNDERSTORMW 50",
	"THUNDERSTORMW WINDS",
	"THUNDERSTORMWINDS",
	"THUNDERSTROM WIND",
	"THUNDERSTROM WINDS",
	"THUNDERTORM WINDS",
	"THUNDERTSORM WIND",
	"THUNDESTORM WINDS",
	"THUNERSTORM WINDS",
	"TIDAL FLOOD",
	"TIDAL FLOODING",
	"TORNADO",
	"TORNADO DEBRIS",
	"TORNADO F0",
	"TORNADO F1",
	"TORNADO F2",
	"TORNADO F3",
	"TORNADO/WATERSPOUT",
	"TORNADOES",
	"TORNADOES, TSTM WIND, HAIL",
	"TORNADOS",
	"TORNDAO",
	"TORRENTIAL RAIN",
	"TROPICAL DEPRESSION",
	"TROPICAL STORM",
	"TROPICAL STORM ALBERTO",
	"TROPICAL STORM DEAN",
	"TROPICAL STORM GORDON",
	"TROPICAL STORM JERRY",
	"TSTM",
	"TSTM HEAVY RAIN",
	"TSTM WIND",
	"TSTM WIND  (G45)",
	"TSTM WIND (41)",
	"TSTM WIND (G35)",
	"TSTM WIND (G40)",
	"TSTM WIND (G45)",
	"TSTM WIND 40",
	"TSTM WIND 45",
	"TSTM WIND 50",
	"TSTM WIND 51",
	"TSTM WIND 52",
	"TSTM WIND 55",
	"TSTM WIND 65)",
	"TSTM WIND AND LIGHTNING",
	"TSTM WIND DAMAGE",
	"TSTM WIND G45",
	"TSTM WIND G58",
	"TSTM WIND/HAIL",
	"TSTM WINDS",
	"TSTM WND",
	"TSTMW",
	"TSUNAMI",
	"TUNDERSTORM WIND",
	"TYPHOON",
	"TEMPERATURE RECORD",
	"THUNDERSNOW SHOWER",
	"TORRENTIAL RAINFALL",
	"UNSEASONABLY COLD",
	"UNSEASONABLY COOL",
	"UNSEASONABLY COOL & WET",
	"UNSEASONABLY DRY",
	"UNSEASONABLY HOT",
	"UNSEASONABLY WARM",
	"UNSEASONABLY WARM & WET",
	"UNSEASONABLY WARM AND DRY",
	"UNSEASONABLY WARM YEAR",
	"UNSEASONABLY WARM/WET",
	"UNSEASONABLY WET",
	"UNSEASONAL LOW TEMP",
	"UNSEASONAL RAIN",
	"UNUSUAL WARMTH",
	"UNUSUAL/RECORD WARMTH",
	"UNUSUALLY COLD",
	"UNUSUALLY LATE SNOW",
	"UNUSUALLY WARM",
	"URBAN AND SMALL",
	"URBAN AND SMALL STREAM",
	"URBAN AND SMALL STREAM FLOOD",
	"URBAN AND SMALL STREAM FLOODIN",
	"URBAN FLOOD",
	"URBAN FLOOD LANDSLIDE",
	"URBAN FLOODING",
	"URBAN FLOODS",
	"URBAN SMALL",
	"URBAN SMALL STREAM FLOOD",
	"URBAN/SMALL",
	"URBAN/SMALL FLOODING",
	"URBAN/SMALL STREAM",
	"URBAN/SMALL STREAM  FLOOD",
	"URBAN/SMALL STREAM FLOOD",
	"URBAN/SMALL STREAM FLOODING",
	"URBAN/SMALL STRM FLDG",
	"URBAN/SML STREAM FLD",
	"URBAN/SML STREAM FLDG",
	"URBAN/STREET FLOODING",
	"UNSEASONABLE COLD",
	"VERY DRY",
	"VERY WARM",
	"VOG",
	"VOLCANIC ASH",
	"VOLCANIC ASHFALL",
	"VOLCANIC ERUPTION",
	"VOLCANIC ASH PLUME",
	"WAKE LOW WIND",
	"WALL CLOUD",
	"WALL CLOUD/FUNNEL CLOUD",
	"WARM DRY CONDITIONS",
	"WARM WEATHER",
	"WATER SPOUT",
	"WATERSPOUT",
	"WATERSPOUT FUNNEL CLOUD",
	"WATERSPOUT TORNADO",
	"WATERSPOUT-",
	"WATERSPOUT-TORNADO",
	"WATERSPOUT/",
	"WATERSPOUT/ TORNADO",
	"WATERSPOUT/TORNADO",
	"WATERSPOUTS",
	"WAYTERSPOUT",
	"WET MICROBURST",
	"WET SNOW",
	"WET WEATHER",
	"WHIRLWIND",
	"WILD FIRES",
	"WILD/FOREST FIRE",
	"WILD/FOREST FIRES",
	"WILDFIRE",
	"WILDFIRES",
	"WIND",
	"WIND ADVISORY",
	"WIND AND WAVE",
	"WIND CHILL",
	"WIND CHILL/HIGH WIND",
	"WIND DAMAGE",
	"WIND GUSTS",
	"WIND STORM",
	"WIND/HAIL",
	"WINDS",
	"WINTER MIX",
	"WINTER STORM",
	"WINTER STORM HIGH WINDS",
	"WINTER STORM/HIGH WIND",
	"WINTER STORM/HIGH WINDS",
	"WINTER STORMS",
	"WINTER WEATHER",
	"WINTER WEATHER MIX",
	"WINTER WEATHER/MIX",
	"WINTERY MIX",
	"WINTRY MIX",
	"WND",
	"WET MONTH",
	"WET YEAR",
	"WET MICOBURST" )

# -- Corresponding standard event types.
# -- There are 2 additional events added here: Other and Ignore.


std.events <- c(
	"High Surf",
	"Coastal Flood",
	"Flash Flood",
	"Lightning",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Waterspout",
	"High Wind",
	"Other",
	"Excessive Heat",
	"Drought",
	"Heavy Rain",
	"Heavy Snow",
	"Frost/Freeze",
	"Other",
	"Coastal Flood",
	"Astronomical Low Tide",
	"Avalanche",
	"Avalanche",
	"High Surf",
	"High Surf",
	"Coastal Flood",
	"Coastal Flood",
	"Drought",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Winter Weather",
	"Blizzard",
	"Blizzard",
	"Blizzard",
	"Blizzard",
	"Blizzard",
	"Blizzard",
	"Blizzard",
	"Blizzard",
	"Astronomical Low Tide",
	"Astronomical Low Tide",
	"Dust Storm",
	"Winter Weather",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Flood",
	"Wildfire",
	"Wildfire",
	"Blizzard",
	"Coastal Flood",
	"Coastal Flood",
	"Coastal Flood",
	"Coastal Flood",
	"Coastal Flood",
	"Storm Surge/Tide",
	"Storm Surge/Tide",
	"Coastal Flood",
	"Coastal Flood",
	"Storm Surge/Tide",
	"Cold/Wind Chill",
	"Funnel Cloud",
	"Funnel Cloud",
	"Tornado",
	"Frost/Freeze",
	"Winter Weather",
	"Winter Weather",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Winter Weather",
	"Cold/Wind Chill",
	"Coastal Flood",
	"Cold/Wind Chill",
	"Flash Flood",
	"Flash Flood",
	"Frost/Freeze",
	"Hail",
	"Dense Fog",
	"Dense Smoke",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Drought",
	"Drought",
	"Drought",
	"Other",
	"Drought",
	"Drought",
	"Drought",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Drought",
	"Drought",
	"Drought",
	"Drought",
	"Dust Devil",
	"Dust Devil",
	"Dust Devil",
	"Dust Storm",
	"Dust Storm",
	"Dust Storm",
	"Winter Weather",
	"Frost/Freeze",
	"Frost/Freeze",
	"Ignore",
	"Winter Weather",
	"Winter Weather",
	"Ignore",
	"Excessive Heat",
	"Drought",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Winter Weather",
	"Heavy Rain",
	"Drought",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Excessive Heat",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Heavy Rain",
	"Coastal Flood",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Ice Storm",
	"Frost/Freeze",
	"Winter Storm",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flood",
	"Flood",
	"Flash Flood",
	"Flash Flood",
	"Ignore",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flash Flood",
	"Flood",
	"Flood",
	"Flood",
	"Flood",
	"Flood",
	"Flood",
	"Dense Fog",
	"Freezing Fog",
	"Wildfire",
	"Frost/Freeze",
	"Frost/Freeze",
	"Frost/Freeze",
	"Freezing Fog",
	"Frost/Freeze",
	"Sleet",
	"Winter Weather",
	"Sleet",
	"Winter Weather",
	"Sleet",
	"Winter Weather",
	"Frost/Freeze",
	"Frost/Freeze",
	"Frost/Freeze",
	"Funnel Cloud",
	"Funnel Cloud",
	"Funnel Cloud",
	"Funnel Cloud",
	"Funnel Cloud",
	"Funnel Cloud",
	"Flood",
	"Frost/Freeze",
	"Freezing Fog",
	"Freezing Fog",
	"Ice Storm",
	"High Wind",
	"High Wind",
	"Wildfire",
	"Blizzard",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Strong Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Strong Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Strong Wind",
	"Strong Wind",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Hail",
	"Frost/Freeze",
	"High Surf",
	"Heat",
	"Drought",
	"Heat",
	"Drought",
	"Heat",
	"Drought",
	"Lake-Effect Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"High Surf",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Ice Storm",
	"Winter Weather",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Blizzard",
	"Blizzard",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Winter Weather",
	"Winter Weather",
	"Flood",
	"Winter Weather",
	"Heavy Snow",
	"Ice Storm",
	"Heavy Snow",
	"Winter Weather",
	"Winter Weather",
	"Winter Storm",
	"Heavy Snow",
	"High Surf",
	"Coastal Flood",
	"High Surf",
	"High Surf",
	"Heavy Snow",
	"High Wind",
	"High Surf",
	"High Wind",
	"High Surf",
	"High Surf",
	"High Surf",
	"High Surf",
	"High Surf",
	"Heat",
	"High Surf",
	"High Surf",
	"High Surf",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"Heavy Snow",
	"Marine High Wind",
	"Marine High Wind",
	"High Wind",
	"Blizzard",
	"Blizzard",
	"Blizzard",
	"Heavy Snow",
	"High Wind",
	"Marine High Wind",
	"Heavy Snow",
	"Blizzard",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"High Wind",
	"Dust Storm",
	"Heavy Rain",
	"High Wind",
	"Coastal Flood",
	"High Wind",
	"Flood",
	"Heavy Rain",
	"High Wind",
	"Flood",
	"Heat",
	"Heat",
	"Heat",
	"Heat",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Hurricane (Typhoon)",
	"Heavy Rain",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Hail",
	"High Wind",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Snow",
	"High Surf",
	"Heat",
	"Hurricane (Typhoon)",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Flood",
	"Winter Weather",
	"Sleet",
	"Winter Weather",
	"Ice Storm",
	"Ice Storm",
	"Ice Storm",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Freezing Fog",
	"Flood",
	"Blizzard",
	"Other",
	"Lake-Effect Snow",
	"Lakeshore Flood",
	"Lake-Effect Snow",
	"Lakeshore Flood",
	"Debris Flow",
	"Debris Flow",
	"Debris Flow",
	"Debris Flow",
	"Tornado",
	"Other",
	"Frost/Freeze",
	"Hail",
	"Winter Weather",
	"Winter Weather",
	"Sleet",
	"Winter Weather",
	"Sleet",
	"Sleet",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Lightning",
	"Flash Flood",
	"Flood",
	"Heavy Rain",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Flood",
	"Marine Hail",
	"Marine High Wind",
	"Other",
	"Marine Strong Wind",
	"Marine Thunderstorm Wind",
	"Marine Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Other",
	"Drought",
	"Flood",
	"Flood",
	"Sleet",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Debris Flow",
	"Debris Flow",
	"Debris Flow",
	"Debris Flow",
	"Debris Flow",
	"Debris Flow",
	"Debris Flow",
	"Other",
	"Thunderstorm Wind", 
	"Other",
	"Heavy Snow",
	"Heavy Snow",
	"Hail",
	"High Wind",
	"High Wind",
	"High Wind",
	"Other",
	"Other",
	"Other",
	"Other",
	"Other",
	"Dense Fog",
	"Winter Weather",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Heat",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Storm Surge/Tide",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Extreme Cold/Wind Chill",
	"Drought",
	"Heat",
	"Heat",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Drought",
	"Heavy Snow",
	"Heavy Rain",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Ignore",
	"Ignore",
	"Excessive Heat",
	"Excessive Heat",
	"Excessive Heat",
	"Heat",
	"Heavy Rain",
	"Lightning",
	"Lightning",
	"Hurricane (Typhoon)",
	"Rip Current",
	"Rip Current",
	"Rip Current",
	"Rip Current",
	"Flood",
	"Flood",
	"Flood",
	"Debris Flow",
	"High Surf",
	"Other",
	"High Surf",
	"High Surf",
	"Flood",
	"Heavy Rain",
	"Heavy Snow",
	"Heavy Snow",
	"Drought",
	"Dust Storm",
	"Seiche",
	"Cold/Wind Chill",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Strong Wind",
	"Sleet",
	"Sleet",
	"Sleet",
	"Sleet",
	"Ice Storm",
	"Sleet",
	"Sleet",
	"Hail",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Dense Smoke",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Heavy Snow",
	"Ice Storm",
	"Sleet",
	"Heavy Snow",
	"Heavy Snow",
	"Sleet",
	"Heavy Snow",
	"Sleet",
	"Heavy Snow",
	"Heavy Snow",
	"Winter Weather",
	"Extreme Cold/Wind Chill",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Sleet",
	"Heavy Snow",
	"Winter Weather",
	"Heavy Snow",
	"Ice Storm",
	"Sleet",
	"Sleet",
	"Sleet",
	"Sleet",
	"Sleet",
	"Heavy Snow",
	"Flood",
	"Winter Storm",
	"Winter Weather",
	"Other",
	"Thunderstorm Wind",
	"Storm Surge/Tide",
	"Storm Surge/Tide",
	"Flood",
	"Flood",
	"Flood",
	"Strong Wind",
	"Strong Wind",
	"Strong Wind",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Heavy Rain",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Ignore",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Heavy Rain",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Flood",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Flood",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Flood",
	"Flood",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Tornado",
	"Heavy Rain",
	"Tropical Depression",
	"Tropical Storm",
	"Tropical Storm",
	"Tropical Storm",
	"Tropical Storm",
	"Tropical Storm",
	"Tropical Storm",
	"Tropical Storm",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Thunderstorm Wind",
	"Tsunami",
	"Thunderstorm Wind",
	"Hurricane (Typhoon)",
	"Ignore",
	"Heavy Snow",
	"Heavy Rain",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"Drought",
	"Heat",
	"Heat",
	"Heat",
	"Heat",
	"Heat",
	"Heat",
	"Heavy Rain",
	"Cold/Wind Chill",
	"Heavy Rain",
	"Heat",
	"Heat",
	"Cold/Wind Chill",
	"Winter Weather",
	"Heat",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Debris Flow",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Heavy Rain",
	"Cold/Wind Chill",
	"Drought",
	"Excessive Heat",
	"Other",
	"Volcanic Ash",
	"Volcanic Ash",
	"Volcanic Ash",
	"Volcanic Ash",
	"High Wind",
	"Other",
	"Funnel Cloud",
	"Drought",
	"Heat",
	"Waterspout",
	"Waterspout",
	"Waterspout",
	"Tornado",
	"Waterspout",
	"Tornado",
	"Waterspout",
	"Tornado",
	"Tornado",
	"Waterspout",
	"Waterspout",
	"Thunderstorm Wind",
	"Winter Weather",
	"Heavy Rain",
	"Dust Devil",
	"Wildfire",
	"Wildfire",
	"Wildfire",
	"Wildfire",
	"Wildfire",
	"High Wind",
	"High Wind",
	"Marine High Wind",
	"Cold/Wind Chill",
	"Cold/Wind Chill",
	"High Wind",
	"High Wind",
	"Strong Wind",
	"Hail",
	"High Wind",
	"Sleet",
	"Winter Storm",
	"Winter Storm",
	"Winter Storm",
	"Winter Storm",
	"Winter Storm",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"Winter Weather",
	"High Wind",
	"Heavy Rain",
	"Heavy Rain",
	"Thunderstorm Wind" )

# Create a conversion datatable that will have 2 columns : non-standard
# uppercase EVTYPE and standard EVTYPE.

conv <- data.table(u.nsev = up.ns.events, std.ev = std.events)

setkey(conv, u.nsev)

# Add the standard event column to ev datatable by joining with conv
# by nonstandard uppercase event type.

ev[conv, s.event := std.ev, nomatch=0]

setkey(ev, s.event)

# Create a new summary datatable ev1 from ev datatable by
# grouping on standard event type.
#
# The ev1 datatable will have all the columns of ev datatable, except
# instead of UP.EVTYPE (uppercase nonstandard event type) it will have
# s.event column (standard event type). The s.event column will be the key.

ev1 <- ev[,list(deaths = sum(dths), injuries = sum(inj),
        propdmg = sum(pdmg), cropdmg = sum(cdmg), tcnt = sum(cnt)),
        keyby = s.event]

```

### Results

The top 10 adverse weather event types causing highest number of fatalities, 
injuries, property damage, crop damage and combined economic damage are
shown below in tabular format along with graphical plots. 

All damage values are shown in billions of USD.

As the tables demonstrate, Tornado is the weather event associated with 
highest number fatalities (5661) as well as injuries (91407).

Flood is the weather event associated with highest property damage (more
than 150 billion USD) as well as combined economic damage (more than 
160 billion USD). Drought is the weather event that causes most crop
damage (more than 13 billion USD) followed closely by Flood (more than
10 billion USD).



```{r, showtable, results="asis", echo=TRUE}

require(xtable)

# Get top 10 causes of death.

dths <- ev1[head(order(-deaths), 10), 
            list(Event = s.event, Cnt = deaths)]

dths1 <- dths[, list(Event = Event, Deaths = as.integer(Cnt))]

# Print as a HTML table.

print(xtable(dths1), type="html")

# Get top 10 causes of injuries.

injs <- ev1[head(order(-injuries),10), 
            list(Event = s.event, Cnt = injuries)]

injs1 <- injs[, list(Event = Event, Injuries = as.integer(Cnt))]

# Print as a HTML table.

print(xtable(injs1), type="html")

# Get top 10 causes of Property damage.

pdmg <- ev1[head(order(-propdmg),10), 
            list(Event = s.event, Dmg = propdmg)]

pdmg1 <- pdmg[, list(Event = Event, 
             Property.Damage.in.Billion.USD = Dmg / (10^9))]

# Print as a HTML table.

print(xtable(pdmg1), type="html")

# Get top 10 causes of Crop damage.

cdmg <- ev1[head(order(-cropdmg),10), 
            list(Event = s.event, Dmg = cropdmg)]

cdmg1 <- cdmg[, list(Event = Event, 
             Crop.Damage.in.Billion.USD = Dmg / (10^9))]

# Print as a HTML table.

print(xtable(cdmg1), type="html")

# Get top 10 causes of combined damage.

cmbdmg <- ev1[head(order(-(cropdmg + propdmg)), 10), 
            list(Event = s.event, Dmg = cropdmg + propdmg)]

cmbdmg1 <- cmbdmg[, list(Event = Event, 
             Combined.Damage.in.Billion.USD = Dmg / (10^9))]

# Print as a HTML table.

print(xtable(cmbdmg1), type="html")
            
```        
            


#### Create The Top 10 Plots (3 plots)    

#### Plot1

```{r, fig.height=12, fig.width=10, echo=TRUE}

# Plot1 and Plot2 both will have 2 subplots each. The fig.height is 
# increased to 12 to accomodate the subplots.
            
# -- Create plot 1 containing 2 subplots.

# Create fatalities subplot

dp <- qplot(data = dths, x = Event, y = Cnt, xlab="Event", 
	    ylab="Number of Fatalities",
	    main = "Top 10 Event Types with Highest Number of Fatalities") +  
	    geom_histogram(stat = "identity") + aes(fill = Event) +
	    theme(axis.text.x = element_text(angle = 30, hjust = 1))

# Create injuries subplot

ip <- qplot(data = injs, x = Event, y = Cnt, xlab="Event", 
            ylab="Number of Injuries",
            main = "Top 10 Event Types with Highest Number of Injuries") +  
    geom_histogram(stat = "identity") + aes(fill = Event) +
    theme(axis.text.x = element_text(angle = 30, hjust = 1))

# Print the two subplots in a  2 x 1 grid.

grid.newpage()
pushViewport(viewport(layout = grid.layout(2, 1)))

print(dp, vp = viewport(layout.pos.row = 1, layout.pos.col = 1))
    
print(ip, vp = viewport(layout.pos.row = 2, layout.pos.col = 1))

```


#### Plot2

```{r, fig.height=12, fig.width=10, echo=TRUE}

# -- Create plot 2 containing 2 subplots.

# Create property damage subplot

pdp <- qplot(data = pdmg, x = Event, y = Dmg /(10^9), xlab="Event", 
    ylab="Property Damage (Billion USD)",
    main = "Top 10 Event Types causing Highest Property Damage") +  
    geom_histogram(stat = "identity") + aes(fill = Event) +
    theme(axis.text.x = element_text(angle = 30, hjust = 1))

# Create crop damage subplot

cdp <- qplot(data = cdmg, x = Event, y = Dmg /(10^9), xlab="Event", 
    ylab="Crop Damage (Billion USD)",
    main = "Top 10 Event Types causing Highest Crop Damage") +  
    geom_histogram(stat = "identity") + aes(fill = Event) +
    theme(axis.text.x = element_text(angle = 30, hjust = 1))
    
# Print the two subplots in a  2 x 1 grid.

grid.newpage()
pushViewport(viewport(layout = grid.layout(2, 1)))

print(pdp, vp = viewport(layout.pos.row = 1, layout.pos.col = 1))
    
print(cdp, vp = viewport(layout.pos.row = 2, layout.pos.col = 1))


```

#### Plot3 

```{r, fig.height=8, fig.width=10, echo=TRUE}

# Plot3 can be smaller in height as it will not have a subplot.

# Create combined damage plot

qplot(data = cmbdmg, x = Event, y = Dmg /(10^9), xlab="Event", 
    ylab="Economic Damage (Billion USD)",
    main = "Top 10 Event Types causing Highest Economic Damage") +  
    geom_histogram(stat = "identity") + aes(fill = Event) +
    theme(axis.text.x = element_text(angle = 30, hjust = 1))
    

```
